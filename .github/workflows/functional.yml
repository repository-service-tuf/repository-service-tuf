name: Functional Tests

on:
  workflow_dispatch:
    inputs:
      api_version:
        description: "API Version"
        default: "dev"
        type: string
        required: False
      worker_version:
        description: "Worker Version"
        default: "dev"
        type: string
        required: False
      cli_version:
        description: "CLI Version"
        default: "dev"
        type: string
        required: False
  workflow_call:
    inputs:
      api_version:
        description: "API Version"
        default: "dev"
        type: string
        required: False
      worker_version:
        description: "Worker Version"
        default: "dev"
        type: string
        required: False
      cli_version:
        description: "CLI Version"
        default: "dev"
        type: string
        required: False
    secrets:
      RSTUF_ONLINE_KEY:
        required: True
env:
  MAKE_FT_TARGET: functional-tests
  REQUIREMENTS_PATH: requirements.txt

jobs:
  full-signed:
    name: "Full Singed Bootstrap"
    uses: ./.github/workflows/FT-full-signed.yml
    with:
      api_version: ${{ inputs.api_version }}
      worker_version: ${{ inputs.worker_version }}
      cli_version: ${{ inputs.cli_version }}
    secrets:
      RSTUF_ONLINE_KEY: ${{ secrets.RSTUF_ONLINE_KEY }}
  das:
    name: "DAS Bootstrap"
    uses: ./.github/workflows/FT-das.yml
    with:
      api_version: ${{ inputs.api_version }}
      worker_version: ${{ inputs.worker_version }}
      cli_version: ${{ inputs.cli_version }}
    secrets:
      RSTUF_ONLINE_KEY: ${{ secrets.RSTUF_ONLINE_KEY }}
